@Library("jenlib@ebrains-4.0") _

Map<String, Object> pipelineOptions = [
		projects: ["hxcomm"],
		setupOptions: "--release-branch=ebrains-4.0",
		container: [app: "dls-core", singularityArgs: "-B /run/munge"],
		notificationChannel: "#dls-software",
		configureInstallOptions: "--build-profile=ci"
]

if (!isTriggeredByGerrit()) {
	pipelineOptions << [
			testSlurmResource: [partition: "cube", wafer: 62, "fpga-without-aout": 3, "mem": 30000],
			preTestHook: { configureHxCubeBitfile() },
			testOptions: "--test-execall -j1",
	]
}

withCcache() {
	wafDefaultPipeline(pipelineOptions)
}
